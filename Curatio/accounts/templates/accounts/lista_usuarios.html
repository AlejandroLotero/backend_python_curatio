{% extends "base.html" %} {# si no tienes base.html, cambia a tu layout o quita extends #}
{% block content %}

<h2>GestiÃ³n de usuarios</h2>

<form method="get" style="margin-bottom: 1rem;">
   <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">

    <input type="text" name="nombre" placeholder="Nombre" value="{{ nombre }}"/>

    <select name="rol">
      <option value="">-- Rol --</option>
      {% for value,label in roles %}
        <option value="{{ value }}" {% if rol == value %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>

    <select name="estado">
      <option value="">-- Estado --</option>
      <option value="1" {% if estado == "1" or estado == "true" or estado == "True" %}selected{% endif %}>Activo</option>
      <option value="0" {% if estado == "0" or estado == "false" or estado == "False" %}selected{% endif %}>Inactivo</option>
    </select>

    <input type="text" name="documento" placeholder="Documento (tipo o nÃºmero)" value="{{ documento }}"/>

    <button type="submit">Filtrar</button>

    <a href="{% url 'lista_usuarios' %}">Limpiar</a>

    <!-- BOTONES REPORTE -->
     <div style="display:flex; gap:8px;">
    <a href="/accounts/reporte-usuarios/?formato=excel&nombre={{ nombre }}&rol={{ rol }}&estado={{ estado }}&documento={{ documento }}">
      ðŸ“Š Descargar Excel
    </a>

    <a href="/accounts/reporte-usuarios/?formato=pdf&nombre={{ nombre }}&rol={{ rol }}&estado={{ estado }}&documento={{ documento }}">
      ðŸ“„ Descargar PDF
    </a>
    </div>

  </div>
</form>


<table border="1" cellpadding="8" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th>Nombre completo</th>
      <th>Tipo de usuario</th>
      <th>Tipo de Documento</th>
      <th>NÃºmero de Documento</th>
      <th>Estado</th>
      <th>Correo personal</th>
      <th>TelÃ©fono</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for u in page_obj %}
      <tr>
        <td>{{ u.nombre }}</td>
        <td>{{ u.rol }}</td>
        <td>{{ u.tipo_documento }}</td>
        <td>{{ u.numero_documento }}</td>
        <td>{% if u.estado %}Activo{% else %}Inactivo{% endif %}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.telefono }}</td>
        <td>
          <a href="{% url 'ver_usuario_admin' u.id %}">Ver</a>
          {# placeholders para lo que pidas luego #}
          {# <a href="#">Editar</a> #}
          {# <a href="#">Deshabilitar</a> #}
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="8">No hay usuarios para mostrar.</td></tr>
    {% endfor %}
  </tbody>
</table>

<div style="margin-top: 1rem;">
  {% if page_obj.has_previous %}
    <a href="?page=1&nombre={{ nombre }}&rol={{ rol }}&estado={{ estado }}&documento={{ documento }}">Â« Primero</a>
    <a href="?page={{ page_obj.previous_page_number }}&nombre={{ nombre }}&rol={{ rol }}&estado={{ estado }}&documento={{ documento }}">â€¹ Anterior</a>
  {% endif %}

  <span style="margin: 0 0.5rem;">
    PÃ¡gina {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
  </span>

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}&nombre={{ nombre }}&rol={{ rol }}&estado={{ estado }}&documento={{ documento }}">Siguiente â€º</a>
    <a href="?page={{ page_obj.paginator.num_pages }}&nombre={{ nombre }}&rol={{ rol }}&estado={{ estado }}&documento={{ documento }}">Ãšltimo Â»</a>
  {% endif %}
</div>

{% endblock %}
